<AMTASK>
<AMTASKHEAD>
    <TASKINFO TASKVERSION="10.0.0.40" />
    <ATTACHMENTINFO ATTACHMENTID="{3B8943BE-FB48-46E4-BA49-861B2FB373DB}" ATTACHMENTPATH="C:\Users\Administrator\Desktop\Sample Task Input Data\Sample Text Files.zip" ATTACHMENTNAME="SampleTextFiles" ATTACHMENTDATE="41522.3735205093" />
</AMTASKHEAD>

<AMFUNCTION NAME="Main" ACCESS="private" RETURNTYPE="variable">
<!-- ------------------------------------------------------------------ -->
<!-- TASK DESCRIPTION: THIS TASK WILL LOOP THROUGH FILES IN A DIRECTORY USING THE 'LOOP FILES' ACTION, READS THE DATA FROM THE CURRENT FILE USING THE 'READ FROM FILE' ACTION AND PLACES THE CONTENTS IN A VARIABLE. THE CONTENTS OF EACH FILE WILL BE DISPLAYED IN A MESSAGE BOX. -->
<!-- ------------------------------------------------------------------ -->
<!-- FILES ARE EMBEDDED IN TASK AND THEN EXTRACTED TO %TEMP%. -->
<AMVARIABLE NAME="VAR_FileName" />
<AMVARIABLE NAME="VAR_Data" />
<AMVARIABLE NAME="VAR_Directory">%TEMP%</AMVARIABLE>
<AMLOOP ACTIVITY="folder" FOLDER="%VAR_Directory%" RESULTVARIABLE="VAR_FileName">
<AMFILESYSTEM ACTIVITY="read_file" FILE="%VAR_FileName%" RESULTVARIABLE="VAR_Data" />
     <AMSHOWDIALOG WINDOWTITLE="CONTENTS OF %VAR_FileName%" BUTTONS="ok_cancel" ONSECONDBUTTONCLICK="stop">HERE ARE THE FIRST 500 CHARACTERS OF %VAR_FileName%:

%Left(VAR_Data, 500)%

Click "OK" to Continue; Click "Cancel" to Stop the task.</AMSHOWDIALOG>
</AMLOOP>
</AMFUNCTION>

<AMFUNCTION NAME="OnStepStart" ACCESS="private">
<AMPARAMETER NAME="FunctionName" DESCRIPTION="The function that is starting the step" SUBTYPE="text" />
<AMPARAMETER NAME="StepNumber" DESCRIPTION="The step number that is about to execute" SUBTYPE="number" />

</AMFUNCTION>

<AMFUNCTION NAME="OnStepEnd" ACCESS="private">
<AMPARAMETER NAME="FunctionName" DESCRIPTION="The function that is ending the step" SUBTYPE="text" />
<AMPARAMETER NAME="StepNumber" DESCRIPTION="The step number that is about to end" SUBTYPE="number" />

</AMFUNCTION>

<AMFUNCTION NAME="OnStepError" ACCESS="private">
<AMPARAMETER NAME="FunctionName" DESCRIPTION="The function with the error" SUBTYPE="text" />
<AMPARAMETER NAME="StepNumber" DESCRIPTION="The step number of the error" SUBTYPE="number" />
<AMPARAMETER NAME="ErrorText" DESCRIPTION="The text of the error" SUBTYPE="text" />
<AMPARAMETER NAME="ErrorCode" DESCRIPTION="The code of the error" SUBTYPE="number" />

</AMFUNCTION>

<AMFUNCTION NAME="OnTaskFailure" ACCESS="private">
<AMPARAMETER NAME="FunctionName" DESCRIPTION="The function causing the task failure" SUBTYPE="text" />
<AMPARAMETER NAME="StepNumber" DESCRIPTION="The step number causing the task failure" SUBTYPE="number" />
<AMPARAMETER NAME="ErrorText" DESCRIPTION="The text of the error" SUBTYPE="text" />
<AMPARAMETER NAME="ErrorCode" DESCRIPTION="The code of the error" SUBTYPE="number" />

</AMFUNCTION>

<AMFUNCTION NAME="OnTaskStart" ACCESS="private">
<AMPARAMETER NAME="Reason" DESCRIPTION="The reason the task is starting" SUBTYPE="text" />

</AMFUNCTION>

<AMFUNCTION NAME="OnTaskEnd" ACCESS="private">
<AMPARAMETER NAME="Reason" DESCRIPTION="The reason the task is ending" SUBTYPE="text" />

</AMFUNCTION>

<ATTACHMENTSSET>
<MIMEATTACHMENT ATTACHMENTID="{3B8943BE-FB48-46E4-BA49-861B2FB373DB}" ATTACHMENTSIZE="588" />
UEsDBBQAAAAIAG+KcEE4ecMUFQAAABYAAAARAAAAZXhjbHVkZV9kYXRlcy50eHQzMDQwNLDg5TIwNzAB0YZGRqYGFgBQSwMEFAAAAAAAb4pwQZX6UN4rAAAAKwAAAA4AAABhcnJheV9saXN0LnR4dFNjb3R0DQpKb2UNCkR1c3Rpbg0KQnJhZA0KUm9uYWsNCk5hdGhhbGllDQpQSwMEFAAAAAgAb4pwQRi4b0IjAAAAYgAAAA4AAABlbWFpbF9saXN0LnR4dEvNTczMMXRIBVHxxalFZalFesn5ubxcYBEjXBLGuCRMMCQAUEsBAhQAFAAAAAgAb4pwQTh5wxQVAAAAFgAAABEAAAAAAAAAAQAgAAAAAAAAAGV4Y2x1ZGVfZGF0ZXMudHh0UEsBAhQAFAAAAAAAb4pwQZX6UN4rAAAAKwAAAA4AAAAAAAAAAQAgAAAARAAAAGFycmF5X2xpc3QudHh0UEsBAhQAFAAAAAgAb4pwQRi4b0IjAAAAYgAAAA4AAAAAAAAAAQAgAAAAmwAAAGVtYWlsX2xpc3QudHh0UEsFBgAAAAADAAMAtwAAAOoAAAAAAA=
</ATTACHMENTSSET>
</AMTASK>
