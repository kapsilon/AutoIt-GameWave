<JobCode Version="2" xmlns="http://WinAutomation.com/JobCode">
  <PlaybackSpeed>0</PlaybackSpeed>
  <VariableList>
    <CVariable>
      <Name>ExistedTitleAndNumber</Name>
    </CVariable>
    <CVariable>
      <Name>HashtagPosition</Name>
    </CVariable>
    <CVariable>
      <Name>ExistedTitle</Name>
    </CVariable>
    <CVariable>
      <Name>ExistedNumber</Name>
    </CVariable>
    <CVariable>
      <Name>RusAppendix</Name>
    </CVariable>
    <CVariable>
      <Name>Appendix</Name>
    </CVariable>
    <CVariable>
      <Name>RussianCount</Name>
    </CVariable>
    <CVariable>
      <Name>Ranging</Name>
    </CVariable>
    <CVariable>
      <Name>Prefix</Name>
    </CVariable>
    <CVariable>
      <Name>Postfix</Name>
    </CVariable>
    <CVariable>
      <Name>RangingStart</Name>
    </CVariable>
    <CVariable>
      <Name>RangingLength</Name>
    </CVariable>
    <CVariable>
      <Name>RangingCount</Name>
    </CVariable>
    <CVariable>
      <Name>Zeroes</Name>
    </CVariable>
    <CVariable>
      <Name>ItsZeroRange</Name>
    </CVariable>
    <CVariable>
      <Name>NewNumber</Name>
    </CVariable>
    <CVariable>
      <Name>FormattedNewNumber</Name>
    </CVariable>
    <CVariable>
      <Name>NewTitleAndNumber</Name>
    </CVariable>
  </VariableList>
  <ActionFlowList>
    <ActionFlow Name="Main Flow">
      <CommentAction Version="2" Enabled="true">
        <Comment><![CDATA[Ввод]]></Comment>
        <BackgroundColor>-3137</BackgroundColor>
      </CommentAction>
      <GetClipboardTextAction Version="1" Enabled="true">
        <Property Name="ClipboardText"><![CDATA[%ExistedTitleAndNumber%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
      </GetClipboardTextAction>
      <CommentAction Version="2" Enabled="true">
        <Comment><![CDATA[Разбираем данные]]></Comment>
        <BackgroundColor>-3137</BackgroundColor>
      </CommentAction>
      <StartRegionAction Version="1" Enabled="true">
        <RegionName>Parsing text</RegionName>
        <RegionExpanse>Expanded</RegionExpanse>
      </StartRegionAction>
      <ParseTextAction Version="2" Enabled="true">
        <Property Name="TextToParse"><![CDATA[%ExistedTitleAndNumber%]]></Property>
        <Property Name="TextToFind"><![CDATA[#]]></Property>
        <Property Name="StartingPos"><![CDATA[0]]></Property>
        <Property Name="OccurrencePositions"><![CDATA[%HashtagPosition%]]></Property>
        <Property Name="AllOccurrences"><![CDATA[%Match%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
        <IsRegEx>false</IsRegEx>
        <FirstOccurrenceOnly>true</FirstOccurrenceOnly>
        <IgnoreCase>false</IgnoreCase>
      </ParseTextAction>
      <IfAction Version="2" Enabled="true">
        <Property Name="FirstOperand"><![CDATA[%HashtagPosition%]]></Property>
        <Property Name="SecondOperand"><![CDATA[0]]></Property>
        <Operator>GreaterOrEqualThan</Operator>
        <CaseSensitiveComparison>false</CaseSensitiveComparison>
      </IfAction>
      <GetSubtextAction Version="1" Enabled="true">
        <Property Name="OriginalText"><![CDATA[%ExistedTitleAndNumber%]]></Property>
        <Property Name="Length"><![CDATA[%HashtagPosition%]]></Property>
        <Property Name="Result"><![CDATA[%ExistedTitle%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
        <StartOfText>true</StartOfText>
        <EndOfText>false</EndOfText>
      </GetSubtextAction>
      <IncreaseVariableAction Version="1" Enabled="true">
        <Property Name="IncreaseBy"><![CDATA[1]]></Property>
        <Property Name="VariableName"><![CDATA[%HashtagPosition%]]></Property>
      </IncreaseVariableAction>
      <GetSubtextAction Version="1" Enabled="true">
        <Property Name="OriginalText"><![CDATA[%ExistedTitleAndNumber%]]></Property>
        <Property Name="StartIndex"><![CDATA[%HashtagPosition%]]></Property>
        <Property Name="Result"><![CDATA[%ExistedNumber%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
        <StartOfText>false</StartOfText>
        <EndOfText>true</EndOfText>
      </GetSubtextAction>
      <EndIfAction Version="1" Enabled="true" />
      <EndRegionAction Version="1" Enabled="true">
        <RegionName>Parsing text</RegionName>
      </EndRegionAction>
      <CommentAction Version="2" Enabled="true">
        <Comment><![CDATA[Для переводов]]></Comment>
        <BackgroundColor>-3137</BackgroundColor>
      </CommentAction>
      <StartRegionAction Version="1" Enabled="true">
        <RegionName>RusTranslation</RegionName>
        <RegionExpanse>Expanded</RegionExpanse>
      </StartRegionAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Value"><![CDATA[rus]]></Property>
        <Property Name="Variable Name"><![CDATA[%RusAppendix%]]></Property>
      </SetVariableAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Name"><![CDATA[%Appendix%]]></Property>
      </SetVariableAction>
      <ParseTextAction Version="2" Enabled="true">
        <Property Name="TextToParse"><![CDATA[%ExistedNumber%]]></Property>
        <Property Name="TextToFind"><![CDATA[%RusAppendix%]]></Property>
        <Property Name="StartingPos"><![CDATA[0]]></Property>
        <Property Name="OccurrencePositions"><![CDATA[%RussianCount%]]></Property>
        <Property Name="AllOccurrences"><![CDATA[%Match%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
        <IsRegEx>false</IsRegEx>
        <FirstOccurrenceOnly>true</FirstOccurrenceOnly>
        <IgnoreCase>false</IgnoreCase>
      </ParseTextAction>
      <IfAction Version="2" Enabled="true">
        <Property Name="FirstOperand"><![CDATA[%RussianCount%]]></Property>
        <Property Name="SecondOperand"><![CDATA[0]]></Property>
        <Operator>GreaterOrEqualThan</Operator>
        <CaseSensitiveComparison>false</CaseSensitiveComparison>
      </IfAction>
      <GetSubtextAction Version="1" Enabled="true">
        <Property Name="OriginalText"><![CDATA[%ExistedNumber%]]></Property>
        <Property Name="StartIndex"><![CDATA[%RussianCount%]]></Property>
        <Property Name="Result"><![CDATA[%Appendix%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
        <StartOfText>false</StartOfText>
        <EndOfText>true</EndOfText>
      </GetSubtextAction>
      <GetSubtextAction Version="1" Enabled="true">
        <Property Name="OriginalText"><![CDATA[%ExistedNumber%]]></Property>
        <Property Name="Length"><![CDATA[%RussianCount%]]></Property>
        <Property Name="Result"><![CDATA[%ExistedNumber%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
        <StartOfText>true</StartOfText>
        <EndOfText>false</EndOfText>
      </GetSubtextAction>
      <EndIfAction Version="1" Enabled="true" />
      <EndRegionAction Version="1" Enabled="true">
        <RegionName>RusTranslation</RegionName>
      </EndRegionAction>
      <CommentAction Version="2" Enabled="true">
        <Comment><![CDATA[Для диапозонов]]></Comment>
        <BackgroundColor>-3137</BackgroundColor>
      </CommentAction>
      <StartRegionAction Version="1" Enabled="true">
        <RegionName>Ranging</RegionName>
        <RegionExpanse>Expanded</RegionExpanse>
      </StartRegionAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Value"><![CDATA[-]]></Property>
        <Property Name="Variable Name"><![CDATA[%Ranging%]]></Property>
      </SetVariableAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Name"><![CDATA[%Prefix%]]></Property>
      </SetVariableAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Name"><![CDATA[%Postfix%]]></Property>
      </SetVariableAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Value"><![CDATA[0]]></Property>
        <Property Name="Variable Name"><![CDATA[%RangingStart%]]></Property>
      </SetVariableAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Value"><![CDATA[%ExistedNumber.Length%]]></Property>
        <Property Name="Variable Name"><![CDATA[%RangingLength%]]></Property>
      </SetVariableAction>
      <IfAction Version="2" Enabled="true">
        <Property Name="FirstOperand"><![CDATA[%RangingLength%]]></Property>
        <Property Name="SecondOperand"><![CDATA[5]]></Property>
        <Operator>GreaterThan</Operator>
        <CaseSensitiveComparison>false</CaseSensitiveComparison>
      </IfAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Value"><![CDATA[%RangingLength%]]></Property>
        <Property Name="Variable Name"><![CDATA[%RangingStart%]]></Property>
      </SetVariableAction>
      <DecreaseVariableAction Version="1" Enabled="true">
        <Property Name="DecreaseBy"><![CDATA[5]]></Property>
        <Property Name="VariableName"><![CDATA[%RangingStart%]]></Property>
      </DecreaseVariableAction>
      <EndIfAction Version="1" Enabled="true" />
      <ParseTextAction Version="2" Enabled="true">
        <Property Name="TextToParse"><![CDATA[%ExistedNumber%]]></Property>
        <Property Name="TextToFind"><![CDATA[%Ranging%]]></Property>
        <Property Name="StartingPos"><![CDATA[%RangingStart%]]></Property>
        <Property Name="OccurrencePositions"><![CDATA[%RangingCount%]]></Property>
        <Property Name="AllOccurrences"><![CDATA[%Match%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
        <IsRegEx>false</IsRegEx>
        <FirstOccurrenceOnly>true</FirstOccurrenceOnly>
        <IgnoreCase>false</IgnoreCase>
      </ParseTextAction>
      <IfAction Version="2" Enabled="true">
        <Property Name="FirstOperand"><![CDATA[%RangingCount%]]></Property>
        <Property Name="SecondOperand"><![CDATA[0]]></Property>
        <Operator>GreaterOrEqualThan</Operator>
        <CaseSensitiveComparison>false</CaseSensitiveComparison>
      </IfAction>
      <GetSubtextAction Version="1" Enabled="true">
        <Property Name="OriginalText"><![CDATA[%ExistedNumber%]]></Property>
        <Property Name="StartIndex"><![CDATA[%Russian%]]></Property>
        <Property Name="Length"><![CDATA[%RangingCount%]]></Property>
        <Property Name="Result"><![CDATA[%Prefix%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
        <StartOfText>true</StartOfText>
        <EndOfText>false</EndOfText>
      </GetSubtextAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Value"><![CDATA[%Prefix%%Ranging%]]></Property>
        <Property Name="Variable Name"><![CDATA[%Prefix%]]></Property>
      </SetVariableAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Value"><![CDATA[*]]></Property>
        <Property Name="Variable Name"><![CDATA[%Postfix%]]></Property>
      </SetVariableAction>
      <IncreaseVariableAction Version="1" Enabled="true">
        <Property Name="IncreaseBy"><![CDATA[1]]></Property>
        <Property Name="VariableName"><![CDATA[%RangingCount%]]></Property>
      </IncreaseVariableAction>
      <DecreaseVariableAction Version="1" Enabled="true">
        <Property Name="DecreaseBy"><![CDATA[%RangingCount%]]></Property>
        <Property Name="VariableName"><![CDATA[%RangingLength%]]></Property>
      </DecreaseVariableAction>
      <DecreaseVariableAction Version="1" Enabled="true">
        <Property Name="DecreaseBy"><![CDATA[1]]></Property>
        <Property Name="VariableName"><![CDATA[%RangingLength%]]></Property>
      </DecreaseVariableAction>
      <GetSubtextAction Version="1" Enabled="true">
        <Property Name="OriginalText"><![CDATA[%ExistedNumber%]]></Property>
        <Property Name="StartIndex"><![CDATA[%RangingCount%]]></Property>
        <Property Name="Length"><![CDATA[%RangingLength%]]></Property>
        <Property Name="Result"><![CDATA[%ExistedNumber%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
        <StartOfText>false</StartOfText>
        <EndOfText>false</EndOfText>
      </GetSubtextAction>
      <EndIfAction Version="1" Enabled="true" />
      <EndRegionAction Version="1" Enabled="true">
        <RegionName>Ranging</RegionName>
      </EndRegionAction>
      <CommentAction Version="2" Enabled="true">
        <Comment><![CDATA[Специальные случаи]]></Comment>
        <BackgroundColor>-3137</BackgroundColor>
      </CommentAction>
      <StartRegionAction Version="1" Enabled="true">
        <RegionName>Zeroes</RegionName>
        <RegionExpanse>Expanded</RegionExpanse>
      </StartRegionAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Name"><![CDATA[%Zeroes%]]></Property>
      </SetVariableAction>
      <ParseTextAction Version="2" Enabled="true">
        <Property Name="TextToParse"><![CDATA[%ExistedTitleAndNumber%]]></Property>
        <Property Name="TextToFind"><![CDATA[#0]]></Property>
        <Property Name="StartingPos"><![CDATA[0]]></Property>
        <Property Name="OccurrencePositions"><![CDATA[%HashtagPosition%]]></Property>
        <Property Name="AllOccurrences"><![CDATA[%Match%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
        <IsRegEx>false</IsRegEx>
        <FirstOccurrenceOnly>true</FirstOccurrenceOnly>
        <IgnoreCase>false</IgnoreCase>
      </ParseTextAction>
      <IfAction Version="2" Enabled="true">
        <Property Name="FirstOperand"><![CDATA[%HashtagPosition%]]></Property>
        <Property Name="SecondOperand"><![CDATA[0]]></Property>
        <Operator>GreaterOrEqualThan</Operator>
        <CaseSensitiveComparison>false</CaseSensitiveComparison>
      </IfAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Value"><![CDATA[0]]></Property>
        <Property Name="Variable Name"><![CDATA[%Zeroes%]]></Property>
      </SetVariableAction>
      <EndIfAction Version="1" Enabled="true" />
      <ParseTextAction Version="2" Enabled="true">
        <Property Name="TextToParse"><![CDATA[%ExistedTitleAndNumber%]]></Property>
        <Property Name="TextToFind"><![CDATA[#09]]></Property>
        <Property Name="StartingPos"><![CDATA[0]]></Property>
        <Property Name="OccurrencePositions"><![CDATA[%HashtagPosition%]]></Property>
        <Property Name="AllOccurrences"><![CDATA[%Match%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
        <IsRegEx>false</IsRegEx>
        <FirstOccurrenceOnly>true</FirstOccurrenceOnly>
        <IgnoreCase>false</IgnoreCase>
      </ParseTextAction>
      <EndRegionAction Version="1" Enabled="true">
        <RegionName>Zeroes</RegionName>
      </EndRegionAction>
      <StartRegionAction Version="1" Enabled="true">
        <RegionName>ZeroRange</RegionName>
        <RegionExpanse>Expanded</RegionExpanse>
      </StartRegionAction>
      <ParseTextAction Version="2" Enabled="true">
        <Property Name="TextToParse"><![CDATA[%ExistedTitleAndNumber%]]></Property>
        <Property Name="TextToFind"><![CDATA[#1*]]></Property>
        <Property Name="StartingPos"><![CDATA[0]]></Property>
        <Property Name="OccurrencePositions"><![CDATA[%ItsZeroRange%]]></Property>
        <Property Name="AllOccurrences"><![CDATA[%Match%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
        <IsRegEx>false</IsRegEx>
        <FirstOccurrenceOnly>true</FirstOccurrenceOnly>
        <IgnoreCase>false</IgnoreCase>
      </ParseTextAction>
      <IfAction Version="2" Enabled="true">
        <Property Name="FirstOperand"><![CDATA[%ItsZeroRange%]]></Property>
        <Property Name="SecondOperand"><![CDATA[0]]></Property>
        <Operator>GreaterOrEqualThan</Operator>
        <CaseSensitiveComparison>false</CaseSensitiveComparison>
      </IfAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Value"><![CDATA[1%Ranging%]]></Property>
        <Property Name="Variable Name"><![CDATA[%Prefix%]]></Property>
      </SetVariableAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Value"><![CDATA[1]]></Property>
        <Property Name="Variable Name"><![CDATA[%ExistedNumber%]]></Property>
      </SetVariableAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Value"><![CDATA[*]]></Property>
        <Property Name="Variable Name"><![CDATA[%Postfix%]]></Property>
      </SetVariableAction>
      <EndIfAction Version="1" Enabled="true" />
      <EndRegionAction Version="1" Enabled="true">
        <RegionName>ZeroRange</RegionName>
      </EndRegionAction>
      <CommentAction Version="2" Enabled="true">
        <Comment><![CDATA[Главная функция]]></Comment>
        <BackgroundColor>-3137</BackgroundColor>
      </CommentAction>
      <StartRegionAction Version="1" Enabled="true">
        <RegionName>Incrementing Number</RegionName>
        <RegionExpanse>Expanded</RegionExpanse>
      </StartRegionAction>
      <ConvertTextToNumberAction Version="1" Enabled="true">
        <Property Name="TextToConvert"><![CDATA[%ExistedNumber%]]></Property>
        <Property Name="Result"><![CDATA[%NewNumber%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
      </ConvertTextToNumberAction>
      <IncreaseVariableAction Version="1" Enabled="true">
        <Property Name="IncreaseBy"><![CDATA[1]]></Property>
        <Property Name="VariableName"><![CDATA[%NewNumber%]]></Property>
      </IncreaseVariableAction>
      <ConvertNumberToTextAction Version="1" Enabled="true">
        <Property Name="NumberToConvert"><![CDATA[%NewNumber%]]></Property>
        <Property Name="Result"><![CDATA[%FormattedNewNumber%]]></Property>
        <DecimalPlaces>0</DecimalPlaces>
        <UseThousandsSeparator>false</UseThousandsSeparator>
      </ConvertNumberToTextAction>
      <EndRegionAction Version="1" Enabled="true">
        <RegionName>Incrementing Number</RegionName>
      </EndRegionAction>
      <CommentAction Version="2" Enabled="true">
        <Comment><![CDATA[Вывод]]></Comment>
        <BackgroundColor>-3137</BackgroundColor>
      </CommentAction>
      <SetVariableAction Version="1" Enabled="true">
        <Property Name="Variable Value"><![CDATA[%ExistedTitle%#%Zeroes%%Prefix%%FormattedNewNumber%%Postfix% %Appendix%]]></Property>
        <Property Name="Variable Name"><![CDATA[%NewTitleAndNumber%]]></Property>
      </SetVariableAction>
      <TrimTextAction Version="1" Enabled="true">
        <Property Name="TextToTrim"><![CDATA[%NewTitleAndNumber%]]></Property>
        <Property Name="Result"><![CDATA[%NewTitleAndNumber%]]></Property>
        <TrimWhat>End</TrimWhat>
      </TrimTextAction>
      <SetClipboardTextAction Version="1" Enabled="true">
        <Property Name="ClipboardText"><![CDATA[%NewTitleAndNumber%]]></Property>
        <OnException RetryAction="false" RetryTimes="1" RetryInterval="3" />
      </SetClipboardTextAction>
    </ActionFlow>
  </ActionFlowList>
</JobCode>